<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Fixed effects models | Linear Mixed Models</title>
  <meta name="description" content="Fixed effects models | Linear Mixed Models" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Fixed effects models | Linear Mixed Models" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Fixed effects models | Linear Mixed Models" />
  <meta name="github-repo" content="stevenworthington/dss-linear-mixed-models" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Fixed effects models | Linear Mixed Models" />
  
  <meta name="twitter:description" content="Fixed effects models | Linear Mixed Models" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="mixed-effects-models.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Linear Mixed Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#table-of-contents"><i class="fa fa-check"></i>Table of Contents</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors-and-sources"><i class="fa fa-check"></i>Authors and Sources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html"><i class="fa fa-check"></i>Fixed effects models</a>
<ul>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#lecture-1.2"><i class="fa fa-check"></i>Lecture 1.2</a></li>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#lecture-2.1"><i class="fa fa-check"></i>Lecture 2.1</a>
<ul>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#fixed-effects-regression"><i class="fa fa-check"></i>Fixed effects regression</a></li>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#level-1-predictors"><i class="fa fa-check"></i>Level 1 predictors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html"><i class="fa fa-check"></i>Mixed effects models</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#lecture-2.3"><i class="fa fa-check"></i>Lecture 2.3</a></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#lecture-2.4"><i class="fa fa-check"></i>Lecture 2.4</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#modeling-assumptions"><i class="fa fa-check"></i>Modeling assumptions</a></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#centering-your-covariates"><i class="fa fa-check"></i>Centering your covariates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#lecture-2.5"><i class="fa fa-check"></i>Lecture 2.5</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#part-i-within-versus-between-centering"><i class="fa fa-check"></i>Part I: within versus between centering</a></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#part-ii-concept-of-maximum-likelihood"><i class="fa fa-check"></i>Part II: Concept of maximum likelihood</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#lecture-2.6"><i class="fa fa-check"></i>Lecture 2.6</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#confidence-intervals"><i class="fa fa-check"></i>confidence intervals</a></li>
<li class="chapter" data-level="" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#inference"><i class="fa fa-check"></i>Inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html"><i class="fa fa-check"></i>Growth curves</a>
<ul>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html#lecture-3.1"><i class="fa fa-check"></i>Lecture 3.1</a>
<ul>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html#growth-curves-1"><i class="fa fa-check"></i>Growth curves</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html#lecture-3.2"><i class="fa fa-check"></i>Lecture 3.2</a>
<ul>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html#quadratic-growth-rb-chapter-6"><i class="fa fa-check"></i>Quadratic growth (R&amp;B chapter 6)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html#lecture-3.2-1"><i class="fa fa-check"></i>Lecture 3.2</a>
<ul>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html#model-building"><i class="fa fa-check"></i>Model Building</a></li>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html#adding-covariates"><i class="fa fa-check"></i>Adding covariates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html#lecture-3.3"><i class="fa fa-check"></i>Lecture 3.3</a>
<ul>
<li class="chapter" data-level="" data-path="growth-curves.html"><a href="growth-curves.html#comparing-models"><i class="fa fa-check"></i>Comparing models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html"><i class="fa fa-check"></i>Many level models</a>
<ul>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html#lecture-4.1"><i class="fa fa-check"></i>Lecture 4.1</a>
<ul>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html#level-2-covariates"><i class="fa fa-check"></i>Level 2 covariates</a></li>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html#level-3-covariates"><i class="fa fa-check"></i>Level 3 covariates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html#lecture-4.2-a"><i class="fa fa-check"></i>Lecture 4.2 (A)</a></li>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html#lecture-4.2-b"><i class="fa fa-check"></i>Lecture 4.2 (B)</a></li>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html#lecture-4.3"><i class="fa fa-check"></i>Lecture 4.3</a>
<ul>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html#potential-outcomes"><i class="fa fa-check"></i>Potential outcomes</a></li>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html#cluster-randomized-trials"><i class="fa fa-check"></i>Cluster Randomized Trials</a></li>
<li class="chapter" data-level="" data-path="many-level-models.html"><a href="many-level-models.html#multisite-experiments"><i class="fa fa-check"></i>Multisite Experiments</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Linear Mixed Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fixed-effects-models" class="section level1">
<h1>Fixed effects models</h1>
<div id="lecture-1.2" class="section level2">
<h2>Lecture 1.2</h2>
<p><span class="math display">\[
MA_i = \beta_0 + \beta_1*SES + \beta_2*I(id=2)... \beta_k*I(id=k)
\]</span></p>
<p>School level fixed effects — allow each school to differ. They will raise or lower the slope of SES depending on the school. The indicators adjust for school-level differences — called <strong>fixed effects</strong>.
<strong>This “completely pools” the SES relationship — it’s the same for each school. THIS IS INCORRECT — FIXED EFFECTS RESULT IN NO POOLING</strong></p>
<p>Drop the intercept when using fixed effects? But this would force SES through the origin, no?</p>
<p>Have NOT pooled the intercept, but HAVE completely pooled the slope.</p>
<p>Models impose structure - if the structure is not true, our model estimates can be wrong.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="fixed-effects-models.html#cb2-1"></a>fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(math <span class="op">~</span><span class="st"> </span>ses <span class="op">*</span><span class="st"> </span>id <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>ses, <span class="dt">data =</span> hsb) </span>
<span id="cb2-2"><a href="fixed-effects-models.html#cb2-2"></a><span class="co"># gives you k slopes and intercepts, where k is the number of schools.</span></span></code></pre></div>
<p>Point estimates the same as fitting each school separately. But, when fitted together, you get one estimate for the residual variance, but when fitted separately, you get different residual variances for each school.</p>
<p>Sorting out the measurement error versus the structure - are the slopes really different or do they just look different?</p>
<p>Inference - separating what is real from what is random.</p>
<p><code>dplyr</code> Data pipeline - data gets handed to the next thing in line, then the output of that gets handed to the next thing in line.</p>
<p>Overdispersion: Dots stacked up. Jitter the dots. Each dot is average of some school. More variance you have across the dots, the more overdispersion you have.</p>
<p>How much modeling flexibility is the right amount? Need a model flexible enough to capture the main structure of the data, but not so flexible that they’re hard to estimate.</p>
</div>
<div id="lecture-2.1" class="section level2">
<h2>Lecture 2.1</h2>
<p>Aggregation is unsatisfying:</p>
<ol style="list-style-type: decimal">
<li>underpowered</li>
<li>biased</li>
<li>heteroscedastic</li>
</ol>
<p>Multilevel models are really lots of models tied together.</p>
<p><em>classic estimate of average for each county</em></p>
<p>Single county <span class="math inline">\(j\)</span></p>
<p><span class="math inline">\(n_j\)</span> houses</p>
<p><span class="math inline">\(Y_{ij}, Y_ni\)</span> -&gt; <span class="math inline">\(stdev(Y_i... Y_nj) = S_j\)</span></p>
<p>-&gt; <span class="math inline">\(\hat{Y}_j\)</span></p>
<p>-&gt; <span class="math inline">\(\hat{SE} = \frac{S_j}{sqrt(n_j)}\)</span></p>
<div id="fixed-effects-regression" class="section level3">
<h3>Fixed effects regression</h3>
<p>Take average value of radon for each county then add value for each house - this is fixed effects regression.</p>
<p><span class="math display">\[
house_i = \alpha_j[i] + \epsilon_i
\]</span></p>
<p>Fixed effects assumes homoscedasticity of the error around the counties - county level variances are the same - with this assumption, we can estimate just one error term for the model. Unlike when you model counties in separate regression models - where you have a separate error term for each model and therefore allow the variance within eaxch county to be different (like GLS).</p>
<p>Shrink estimates towards a common mean. House <span class="math inline">\(i\)</span> in county <span class="math inline">\(j[i]\)</span>.</p>
<p><span class="math display">\[
y_i = \alpha_j[i] + \epsilon_i \\
\epsilon_i ~ N(0, \sigma^2_\alpha) \\
\alpha_j ~ N(\mu, \sigma^2_\alpha) %% &quot;soft constraint&quot;: this ties the intercepts together
\]</span></p>
<p><span class="math inline">\(\alpha_j\)</span> are the county means. <span class="math inline">\(\mu\)</span> is the grand mean of the county means (NOT the same as the mean of all the houses). <span class="math inline">\(\sigma^2_\alpha\)</span> is the variance of the county means.</p>
<p>Shrinkage - a weighted average of the mean for the county and the grand mean of the counties.
Shrinkage = empirical Bayes estimate. Tend to be underdispersed, compared to the overdispered fixed effects estimates.</p>
<p>Bias-variance trade off - can introduce some bias into the estimates in return for removing a lot of variance. This will result in better estimates overall.</p>
</div>
<div id="level-1-predictors" class="section level3">
<h3>Level 1 predictors</h3>
<p>Basement floor indicator.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="fixed-effects-models.html#cb3-1"></a><span class="kw">coef</span>(model)<span class="op">$</span>county <span class="co"># get the empirical Bayes estimates for each county</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mixed-effects-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/IQSS/dss-linear-mixed-models/edit/master/01_Fixed_effects_models.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Linear_mixed_models.pdf", "Linear_mixed_models.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
